{
    "collab_server" : "",
    "contents" : "---\ntitle       : Full Moon and Crime Rates in the City of Chicago\nsubtitle    : Assignment work of Developing Data Products by JHU on Coursera\nauthor      : T-StrawClown\njob         : \nframework   : io2012        # {io2012, html5slides, shower, dzslides, ...}\nhighlighter : highlight.js  # {highlight.js, prettify, highlight}\nhitheme     : tomorrow      # \nwidgets     : [bootstrap, quiz]            # {mathjax, quiz, bootstrap}\nmode        : selfcontained # {standalone, draft}\nknit        : slidify::knit2slides\n---\n\n## Crimes Per Month by Moon Phases \nFirst lets check how crime rates look overall split by moon phase (drag to zoom, right-click to reset).\n```{r permonth, message = F, error = F, warning = F, comment = NA, echo = F, results = 'asis', cache.vars=c(\"crimes.by_yearmonth\")}\nlibrary(googleVis)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(knitr)\nlibrary(ggplot2)\n\nload(\"data/crimes.RData\")\n\ncrimes.by_yearmonth <- crimes.by_day %>%\n    mutate(ym = as.POSIXct(paste(year, month, \"01\", sep = \"-\"))) %>%\n    #mutate(ym = as.numeric(as.POSIXct(paste(year, month, \"01\", sep = \"-\")))) %>%\n    group_by(ym, moon) %>%\n    summarize(cnt = sum(cnt)) %>%\n    filter(!is.na(ym)) %>%\n    spread(moon, cnt)\n\nc1 <- gvisLineChart(data = crimes.by_yearmonth,\n                    xvar = \"ym\",\n                    yvar = c(\"New\", \"Waxing\", \"Full\", \"Waning\"),\n                    options = list(colors=\"['#e41a1c', '#377eb8', '#4daf4a', '#984ea3']\",\n                                   curveType = \"function\",\n                                   width = 1000,\n                                   height = 400,\n                                   explorer = \"{actions: ['dragToZoom', 'rightClickToReset']}\"))\ncat(c1$html$chart)\n```\nDoesn't seem that there is something special about full moon. BTW more detailed data can be found in my shiny application [here] (https://tstrawclown.shinyapps.io/DDPCourseProject)\n\n--- .class #id\n\n\n## Top 5 Crime Types\nHere is another look. Here are top 5 types of crimes committed during full moon.\n```{r columns, message = F, error = F, warning = F, comment = NA, echo = F, results = 'asis', cache.vars=c(\"crimes.by_typetop5\", \"crimes.by_type\", \"crimes.by_typefullmoon\")}\ncrimes.by_type <- crimes.tidy %>%\n  #filter(moon == \"Full\") %>%\n  group_by(type, moon) %>%\n  summarize(cnt = n()) %>%\n  arrange(desc(cnt))\ncrimes.by_typefullmoon <- crimes.tidy %>%\n  filter(moon == \"Full\") %>%\n  group_by(type) %>%\n  summarize(cnt = n()) %>%\n  arrange(desc(cnt)) %>%\n  top_n(5)\ncrimes.by_typetop5 <- \n  inner_join(crimes.by_type, crimes.by_typefullmoon, by = c(\"type\" = \"type\")) %>%\n  select(type, moon, cnt = cnt.x) %>%\n  group_by(type) \ncrimes.by_typetop5 <- crimes.by_typetop5 %>%\n  spread(moon, cnt) %>%\n  arrange(desc(Full), type)\n\nc2 <- gvisColumnChart(data = crimes.by_typetop5,\n                      xvar = \"type\",\n                      options = list(width = 1000,\n                                    height = 400,\n                                    colors=\"['#e41a1c', '#377eb8', '#4daf4a', '#984ea3']\"))\ncat(c2$html$chart)\n```\nDoesn't look promising too...\n\n--- &twocol w1:50% w2:50%\n\n### Statistical Perspective\n```{r, message = F, error = F, warning = F, comment = NA, echo = F, results = 'asis'}\nfull.ds <- subset(crimes.by_day, moon == \"Full\")\nnonfull.ds <- subset(crimes.by_day, moon != \"Full\")\nfull.sims <- matrix(data = sample(full.ds$cnt,\n                                  1000 * 1000,\n                                  replace = T),\n                    nrow = 1000,\n                    ncol = 1000)\nnonfull.sims <- matrix(data = sample(nonfull.ds$cnt,\n                                     1000 * 1000,\n                                     replace = T),\n                       nrow = 1000,\n                       ncol = 1000)\nfull.means <- apply(full.sims, 1, mean)\nnonfull.means <- apply(nonfull.sims, 1, mean)\n```\n\n*** =left\nDistribution from all data (starting from year 2009)\n\n```{r, message = F, error = F, warning = F, comment = NA, echo = F, results = 'asis', fig.width=7, fig.height=5, fig.align='left', dpi=100}\nc3 <- ggplot(data = crimes.by_day,\n           aes(x = cnt, color = moon)) +\n    geom_density(show.legend = F) +\n    stat_density(geom = \"line\",\n                 position = \"identity\") +\n    #scale_color_brewer(type = \"qual\", guide = \"legend\") +\n    scale_color_manual(values = c(\"#e41a1c\", \"#377eb8\", \"#4daf4a\", \"#984ea3\")) +\n    geom_density(data = subset(crimes.by_day, moon == \"Full\"),\n                 aes(x = cnt),\n                 color = \"#4daf4a\",\n                 size = 1.2,\n                 show.legend = F) +\n    ggtitle(\"Density of crimes per day\") +\n    ylab(\"\") + xlab(\"\") + theme(legend.position = c(0.9, 0.8),\n                                legend.background = element_blank())\nprint(c3)\n```\n\n*** =right\n1K x 1K Bootstrap simulations (with replacement)\n\n```{r, message = F, error = F, warning = F, comment = NA, echo = F, results = 'asis', fig.width=7, fig.height=5, fig.align='left', dpi=100}\nc4 <- ggplot() +\n    geom_density(data = as.data.frame(full.means),\n                 aes(x = full.means),\n                 color = \"#4daf4a\",\n                 size = 1.2,\n                 show.legend = F) +\n    stat_density(data = as.data.frame(full.means),\n                 aes(x = full.means, color = \"Full\"),\n                 geom = \"line\",\n                 position = \"identity\") +\n    geom_vline(xintercept = mean(full.means) + c(-1,1) * qnorm(.975) * sd(full.means),\n               linetype = \"dashed\",\n               color = \"#4daf4a\") +\n    geom_vline(xintercept = mean(full.means),\n               color = \"#4daf4a\") +\n    geom_density(data = as.data.frame(nonfull.means),\n                 aes(x = nonfull.means),\n                 color = \"salmon\",\n                 show.legend = F) +\n    stat_density(data = as.data.frame(nonfull.means),\n                 aes(x = nonfull.means, color = \"Other\"),\n                 geom = \"line\",\n                 position = \"identity\") +\n    geom_vline(xintercept = mean(nonfull.means) + c(-1,1) * qnorm(.975) * sd(nonfull.means),\n               linetype = \"dashed\",\n               color = \"salmon\") +\n    geom_vline(xintercept = mean(nonfull.means),\n               color = \"salmon\") +\n    scale_colour_manual(name = \"moon\", \n                        values = c(\"Full\" = \"#4daf4a\", \"Other\"=\"salmon\"),\n                        labels = c(\"Full\", \"Other\"),\n                        guide = \"legend\") +\n    ggtitle(\"Density of simulated means of crimes per day\") +\n    xlab(\"\") + ylab(\"\") + theme(legend.position = c(0.9, 0.8),\n                                legend.background = element_blank())\nprint(c4)\n```\n\n--- &radio\n\n### Quiz\n# The Ultimate Question\n\nSo after looking at these slides what do you think about statement that there are more crimes committed when the moon is full?\n\n1. There is no such myth\n2. _There is no statistical evidence of that_\n3. It can be clearly seen that it is true\n4. 42\n\n*** .hint\nNo hints, sorry. You'll have to figure it out yourself\n\n*** .explanation\nWell from this presentation you can see that it is more likely that the opposite is true. Though the difference is not statistically significant.\n\nBut we both know that the true answer to the Ultimate Question is [42] (http://www.urbandictionary.com/define.php?term=42)\n\n",
    "created" : 1468338984287.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "464927962",
    "id" : "FB65CF73",
    "lastKnownWriteTime" : 1468428113,
    "last_content_update" : 1468428113422,
    "path" : "D:/Coursera/data_science/gitrepo/DDPSlidify/index.Rmd",
    "project_path" : "index.Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}